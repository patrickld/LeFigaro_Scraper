import re
from math import *

#removes html tags from the input list
def cleaner(liste):
    CLEAN = re.compile(r'\s+')
    return [CLEAN.sub(' ', a.text).strip().replace(",", ".") for a in liste]

#extracts the price value
def price_cleaner(price):

    price_clean=[]
    for digits in price:
        digits = digits.rstrip()
        x = re.findall ('([0-9.]+)', digits)
        if x == []:
            price_clean.append(0)
        else:
            x = [''.join(x).replace(',','.')]
            price_clean.append(int(float(x[0])))
    return price_clean

#extracts the square meter from the title
def sq_clean(title):
    square_meters=[]

    for sq in title:
        sq = str(sq).rstrip()
        x = re.findall (r'\s([0-9-,-.]*)\sm2', sq)
        if x == []:
        #In case there is parkings or orther rantal with no squaremeters specified
            square_meters.append('0')
        else:
            square_meters.append(x)

    square_meters_flat = []
    for sublist in square_meters:
        for item in sublist:
            square_meters_flat.append(item)


#Removing the coma in order to convert square meter into an integer
    sq_float = []
    for sq in square_meters_flat:
        sq = float(sq.replace(',','.'))
        sq_float.append(sq)
    return sq_float

#extracts if the apt is furnished from title
def is_it_furniture(title):
    furniture = []
    furnished = None
    for item in title:
        item = str(item).rstrip()
        x = re.findall ('(meublé)', item)
        if 'meublé' in x:
            furnished = True
            furniture.append(furnished)
        else:
            furnished = False
            furniture.append(furnished)
    return furniture

#extracts how many rooms there are in the apt from title
def how_many_room(title):
    room = []
    for room_nbr in title:
        room_nbr = str(room_nbr).rstrip()
        x = re.findall ('\s([0-9])\s\S*\s', room_nbr)
        if x == []:
            room.append(1)
        else:
            room.append(x[0])
    return room

#extracts the arrondissement from title
def location(title):
    arr = []
    for arrondissement in title:
        arrondissement = str(arrondissement).rstrip()
        x = re.findall ('Paris\s([0-9]+)*', arrondissement)
        arr.append(x[0])
    return arr
